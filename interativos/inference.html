<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demonstra√ß√£o Interativa da Infer√™ncia GPT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/js/integration.js"></script>
    <script src="/js/inference-ui.js"></script>
    <link rel="stylesheet" href="css/design-system.css">
    <style>
        /* Estilos espec√≠ficos para infer√™ncia */
        .token {
            display: inline-block;
            padding: 4px 8px;
            margin: 2px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        .token.input {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: 2px solid #60a5fa;
        }
        .token.generated {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: 2px solid #34d399;
            animation: tokenAppear 0.5s ease-out;
        }
        .token.current {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border: 2px solid #fbbf24;
            animation: pulse 1s infinite;
        }
        .token:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        @keyframes tokenAppear {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(-10px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        /* Estilos para tokens na visualiza√ß√£o */
        .token-item {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.2));
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 8px 12px;
            margin: 2px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .token-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.6);
        }
        
        .token-item.active {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(5, 150, 105, 0.3));
            border-color: rgba(16, 185, 129, 0.6);
            animation: tokenPulse 1s ease-in-out infinite;
        }
        
        .token-item.flowing {
            animation: tokenFlow 2s ease-in-out;
        }
        
        @keyframes tokenPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes tokenFlow {
            0% { transform: translateX(0) scale(1); }
            25% { transform: translateX(10px) scale(1.1); }
            75% { transform: translateX(-10px) scale(1.1); }
            100% { transform: translateX(0) scale(1); }
        }
        
        .token-text {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            font-size: 14px;
            color: #e2e8f0;
            margin-bottom: 2px;
        }
        
        .token-id {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: rgba(148, 163, 184, 0.7);
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        /* Anima√ß√£o da seta de tokeniza√ß√£o */
        .tokenization-arrow {
            display: flex;
            align-items: center;
            animation: arrowBounce 2s ease-in-out infinite;
        }
        
        @keyframes arrowBounce {
             0%, 100% { transform: translateY(0); }
             50% { transform: translateY(-5px); }
         }
         
         /* Fluxo de infer√™ncia */
         .inference-flow {
             position: relative;
             padding: 20px 0;
         }
         
         .flow-step {
             display: flex;
             align-items: center;
             margin: 15px 0;
             padding: 15px;
             background: rgba(0, 0, 0, 0.2);
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 12px;
             transition: all 0.3s ease;
             opacity: 0.6;
         }
         
         .flow-step.active {
             background: rgba(59, 130, 246, 0.15);
             border-color: rgba(59, 130, 246, 0.4);
             transform: scale(1.02);
             opacity: 1;
             box-shadow: 0 4px 20px rgba(59, 130, 246, 0.2);
         }
         
         .flow-step.completed {
             background: rgba(16, 185, 129, 0.15);
             border-color: rgba(16, 185, 129, 0.4);
             opacity: 1;
         }
         
         .flow-step-icon {
             width: 50px;
             height: 50px;
             border-radius: 50%;
             display: flex;
             align-items: center;
             justify-content: center;
             margin-right: 20px;
             font-size: 20px;
             background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(147, 51, 234, 0.3));
             border: 2px solid rgba(59, 130, 246, 0.4);
             transition: all 0.3s ease;
         }
         
         .flow-step.active .flow-step-icon {
             background: linear-gradient(135deg, rgba(16, 185, 129, 0.4), rgba(5, 150, 105, 0.4));
             border-color: rgba(16, 185, 129, 0.6);
             animation: iconPulse 2s ease-in-out infinite;
         }
         
         @keyframes iconPulse {
             0%, 100% { transform: scale(1); }
             50% { transform: scale(1.1); }
         }
         
         .flow-tokens {
             display: flex;
             flex-wrap: wrap;
             gap: 6px;
             margin-top: 12px;
             min-height: 40px;
             align-items: center;
         }
         
         .flow-token {
             background: rgba(59, 130, 246, 0.2);
             border: 1px solid rgba(59, 130, 246, 0.3);
             border-radius: 8px;
             padding: 6px 12px;
             font-family: 'JetBrains Mono', monospace;
             font-size: 13px;
             color: #93c5fd;
             transition: all 0.3s ease;
             position: relative;
             overflow: hidden;
         }
         
         .flow-token.highlighted {
             background: rgba(16, 185, 129, 0.3);
             border-color: rgba(16, 185, 129, 0.5);
             color: #6ee7b7;
             animation: tokenHighlight 0.8s ease-out;
             transform: scale(1.05);
         }
         
         .flow-token.moving {
             animation: tokenMove 1.5s ease-in-out;
         }
         
         @keyframes tokenHighlight {
             0% { transform: scale(1); box-shadow: none; }
             50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(16, 185, 129, 0.5); }
             100% { transform: scale(1.05); box-shadow: 0 0 10px rgba(16, 185, 129, 0.3); }
         }
         
         @keyframes tokenMove {
             0% { transform: translateX(0); }
             25% { transform: translateX(20px); }
             75% { transform: translateX(-20px); }
             100% { transform: translateX(0); }
         }
         
         @keyframes tokenFlow {
             0% {
                 transform: translateY(0) scale(1);
                 opacity: 0.7;
             }
             50% {
                 transform: translateY(-10px) scale(1.1);
                 opacity: 1;
                 box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
             }
             100% {
                 transform: translateY(0) scale(1);
                 opacity: 0.8;
             }
         }
         
         @keyframes tokenTransition {
             0% {
                 transform: translateX(0) rotate(0deg);
                 background: rgba(59, 130, 246, 0.2);
             }
             25% {
                 transform: translateX(30px) rotate(5deg);
                 background: rgba(147, 51, 234, 0.3);
             }
             50% {
                 transform: translateX(60px) rotate(0deg);
                 background: rgba(16, 185, 129, 0.3);
             }
             75% {
                 transform: translateX(30px) rotate(-5deg);
                 background: rgba(245, 158, 11, 0.3);
             }
             100% {
                 transform: translateX(0) rotate(0deg);
                 background: rgba(239, 68, 68, 0.3);
             }
         }
         
         .flow-token.transitioning {
             animation: tokenTransition 2s ease-in-out;
         }
         
         .flow-token.flowing {
             animation: tokenFlow 1.5s ease-in-out infinite;
         }
         
         /* Efeito de conex√£o entre etapas */
         .flow-connection {
             position: absolute;
             left: 50%;
             bottom: -20px;
             width: 4px;
             height: 20px;
             background: linear-gradient(to bottom, 
                 rgba(59, 130, 246, 0.6), 
                 rgba(16, 185, 129, 0.4));
             border-radius: 2px;
             transform: translateX(-50%);
             opacity: 0;
             transition: opacity 0.5s ease;
         }
         
         .flow-step.active .flow-connection {
             opacity: 1;
             animation: connectionPulse 2s ease-in-out infinite;
         }
         
         @keyframes connectionPulse {
             0%, 100% { 
                 transform: translateX(-50%) scaleY(1);
                 opacity: 0.6;
             }
             50% { 
                 transform: translateX(-50%) scaleY(1.2);
                 opacity: 1;
             }
         }
         
         /* Conectores entre etapas */
         .flow-step::after {
             content: '';
             position: absolute;
             left: 25px;
             bottom: -15px;
             width: 2px;
             height: 15px;
             background: linear-gradient(to bottom, rgba(59, 130, 246, 0.3), transparent);
             transition: all 0.3s ease;
         }
         
         .flow-step:last-child::after {
             display: none;
         }
         
         .flow-step.active::after {
             background: linear-gradient(to bottom, rgba(16, 185, 129, 0.6), rgba(59, 130, 246, 0.3));
         }
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 0 10px rgba(251, 191, 36, 0);
            }
        }
        .probability-bar {
            height: 20px;
            background: #374151;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            margin: 4px 0;
        }
        .probability-fill {
            height: 100%;
            background: linear-gradient(90deg, #ef4444, #f97316, #eab308, #22c55e);
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
        }
        .probability-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .beam {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(99, 102, 241, 0.2));
            border: 2px solid #8b5cf6;
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        .beam:hover {
            border-color: #a78bfa;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(99, 102, 241, 0.3));
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }
        .beam.selected {
            border-color: #fbbf24;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2));
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.4);
        }
        .beam-score {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(139, 92, 246, 0.9);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
        }
        .attention-head {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            border-radius: 8px;
            padding: 8px;
            margin: 4px;
            color: white;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .attention-head:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
        }
        .attention-head.active {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            animation: glow 1s infinite alternate;
        }
        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(245, 158, 11, 0.5); }
            100% { box-shadow: 0 0 20px rgba(245, 158, 11, 0.8); }
        }
        .generation-step {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
            border: 2px solid #10b981;
            border-radius: 12px;
            padding: 16px;
            margin: 8px 0;
            transition: all 0.3s ease;
            position: relative;
        }
        .generation-step.active {
            border-color: #fbbf24;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2));
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.4);
        }
        .step-number {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .temperature-slider {
            background: linear-gradient(90deg, #3b82f6, #ef4444);
            height: 8px;
            border-radius: 4px;
            position: relative;
        }
        .temperature-thumb {
            position: absolute;
            top: -6px;
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .temperature-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }
        .sampling-method {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.1));
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 12px;
            margin: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .sampling-method:hover {
            border-color: #60a5fa;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(99, 102, 241, 0.2));
            transform: translateY(-2px);
        }
        .sampling-method.active {
            border-color: #fbbf24;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2));
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.4);
        }
        .logit-bar {
            background: #374151;
            height: 30px;
            border-radius: 15px;
            margin: 4px 0;
            position: relative;
            overflow: hidden;
        }
        .logit-fill {
            height: 100%;
            background: linear-gradient(90deg, #dc2626, #ef4444, #f97316, #eab308, #22c55e);
            border-radius: 15px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 12px;
        }
        .progress-ring {
            transform: rotate(-90deg);
        }
        .progress-ring-circle {
            transition: stroke-dasharray 0.5s ease;
        }
        .inference-visualization {
            background: radial-gradient(circle, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.3));
            border: 2px solid #3b82f6;
            border-radius: 50%;
            width: 200px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            position: relative;
        }
        .inference-point {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #fbbf24;
            border-radius: 50%;
            animation: orbit 3s linear infinite;
        }
        @keyframes orbit {
            0% { transform: rotate(0deg) translateX(80px) rotate(0deg); }
            100% { transform: rotate(360deg) translateX(80px) rotate(-360deg); }
        }
        .metric-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        /* Estados dos Bot√µes */
        .btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            font-weight: 600;
            border-radius: 12px;
            padding: 12px 24px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: linear-gradient(135deg, #1d4ed8, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        
        .btn-loading {
            background: linear-gradient(135deg, #6b7280, #4b5563) !important;
            cursor: wait !important;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669) !important;
            animation: successPulse 0.6s ease-out;
        }
        
        .btn-error {
            background: linear-gradient(135deg, #ef4444, #dc2626) !important;
            animation: errorShake 0.6s ease-out;
        }
        
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* Spinner de Loading */
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin: 12px 0;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399);
            border-radius: 3px;
            transition: width 0.3s ease;
            position: relative;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: progressShimmer 1.5s infinite;
        }
        
        @keyframes progressShimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* Status Messages */
        .status-message {
            padding: 12px 16px;
            border-radius: 8px;
            margin: 8px 0;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.3s ease-out;
        }
        
        .status-info {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #60a5fa;
        }
        
        .status-success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #34d399;
        }
        
        .status-warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #fbbf24;
        }
        
        .status-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #f87171;
        }
        
        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateY(-10px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Typing Animation */
        .typing-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background: #10b981;
            border-radius: 50%;
            animation: typingBounce 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typingBounce {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }
        
        /* === Estilos Aprimorados para Interface de Infer√™ncia === */
        
        /* Bot√µes com estados visuais aprimorados */
        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
            min-height: 48px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        
        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
            box-shadow: 0 4px 15px rgba(107, 114, 128, 0.3);
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: linear-gradient(135deg, #5b6470, #374151);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(107, 114, 128, 0.4);
        }
        
        .btn-outline {
            background: rgba(255, 255, 255, 0.05);
            color: #e5e7eb;
            border: 2px solid rgba(107, 114, 128, 0.5);
            backdrop-filter: blur(10px);
        }
        
        .btn-outline:hover:not(:disabled) {
            background: rgba(107, 114, 128, 0.15);
            border-color: #9ca3af;
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .btn-loading {
            opacity: 0.8;
            cursor: not-allowed;
            pointer-events: none;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669) !important;
            animation: successPulse 0.6s ease-out;
        }
        
        .btn-error {
            background: linear-gradient(135deg, #ef4444, #dc2626) !important;
            animation: errorShake 0.6s ease-out;
        }
        
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* Spinner de carregamento aprimorado */
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Mensagens de status aprimoradas */
        .status-message {
            padding: 12px 16px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            font-weight: 500;
            margin: 8px 0;
            backdrop-filter: blur(10px);
            animation: statusSlideIn 0.3s ease-out;
        }
        
        @keyframes statusSlideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .status-info {
            background: rgba(59, 130, 246, 0.15);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #93c5fd;
        }
        
        .status-success {
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #6ee7b7;
        }
        
        .status-warning {
            background: rgba(245, 158, 11, 0.15);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #fcd34d;
        }
        
        .status-error {
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }
        
        /* M√©tricas de gera√ß√£o */
        .metrics-grid {
            animation: metricsSlideIn 0.5s ease-out;
        }
        
        @keyframes metricsSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .metric-card {
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            background: rgba(0, 0, 0, 0.3) !important;
        }
        
        .metric-value {
            font-family: 'JetBrains Mono', monospace;
            transition: all 0.3s ease;
        }
        
        /* Responsividade aprimorada */
        @media (max-width: 768px) {
            .btn {
                padding: 10px 20px;
                font-size: 13px;
                min-height: 44px;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .metric-card {
                padding: 12px !important;
            }
            
            .progress-container {
                padding: 12px;
            }
            
            .status-message {
                padding: 10px 14px;
                font-size: 13px;
            }
        }
        
        @media (max-width: 480px) {
            .btn {
                padding: 8px 16px;
                font-size: 12px;
                min-height: 40px;
            }
            
            .metric-value {
                font-size: 16px !important;
            }
            
            .metric-label {
                font-size: 10px !important;
            }
        }
        
        /* Anima√ß√µes para etapas */
        .step-item {
            transition: all 0.3s ease;
        }
        
        .step-item.active {
            background: rgba(59, 130, 246, 0.2) !important;
            border-color: #3b82f6 !important;
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        
        /* Melhorias para tokens gerados */
        .token.generated {
            animation: tokenAppear 0.5s ease-out, tokenGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes tokenGlow {
            from {
                box-shadow: 0 0 5px rgba(16, 185, 129, 0.3);
            }
            to {
                box-shadow: 0 0 15px rgba(16, 185, 129, 0.6);
            }
        }
        
        /* Sistema de Notifica√ß√µes Toast */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
            pointer-events: none;
        }
        
        .toast {
            padding: 16px 20px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: translateX(100%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            pointer-events: auto;
            min-width: 300px;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.hide {
            transform: translateX(100%);
            opacity: 0;
        }
        
        .toast::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: currentColor;
            animation: toastProgress 4s linear;
        }
        
        @keyframes toastProgress {
            from { width: 100%; }
            to { width: 0%; }
        }
        
        .toast.success {
            background: linear-gradient(135deg, #10b981, #059669);
            border-color: rgba(16, 185, 129, 0.3);
        }
        
        .toast.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .toast.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border-color: rgba(245, 158, 11, 0.3);
        }
        
        .toast.info {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .toast-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .toast-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .toast-message {
            flex: 1;
            line-height: 1.4;
        }
        
        .toast-title {
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .toast-description {
            font-size: 13px;
            opacity: 0.9;
        }
        
        .toast-close {
            position: absolute;
            top: 8px;
            right: 12px;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 18px;
            opacity: 0.7;
            transition: opacity 0.2s;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .toast-close:hover {
            opacity: 1;
        }
        
        /* Indicadores de Progresso Detalhados */
        .detailed-progress {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin: 12px 0;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .progress-title {
            font-weight: 600;
            font-size: 14px;
        }
        
        .progress-percentage {
            font-weight: 600;
            font-size: 14px;
            color: #10b981;
        }
        
        .progress-track {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #10b981);
            border-radius: 4px;
            transition: width 0.3s ease;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShimmer 1.5s infinite;
        }
        
        .progress-details {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 12px;
            color: #9ca3af;
        }
        
        .progress-eta {
            font-weight: 500;
        }
        
        /* Badges e Contadores */
        .stats-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin: 12px 0;
        }
        
        .stat-badge {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #93c5fd;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .stat-badge.success {
            background: rgba(16, 185, 129, 0.2);
            border-color: rgba(16, 185, 129, 0.3);
            color: #6ee7b7;
        }
        
        .stat-badge.warning {
            background: rgba(245, 158, 11, 0.2);
            border-color: rgba(245, 158, 11, 0.3);
            color: #fcd34d;
        }
        
        .stat-badge.error {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }
        
        .badge-icon {
            font-size: 14px;
        }
        
        /* Logs em Tempo Real */
        .realtime-logs {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            margin: 12px 0;
            max-height: 200px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }
        
        .log-entry {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 4px;
            padding: 2px 0;
        }
        
        .log-timestamp {
            color: #6b7280;
            font-size: 11px;
            min-width: 60px;
        }
        
        .log-level {
            font-weight: 600;
            min-width: 50px;
        }
        
        .log-level.info { color: #60a5fa; }
        .log-level.success { color: #34d399; }
        .log-level.warning { color: #fbbf24; }
        .log-level.error { color: #f87171; }
        
        .log-message {
            flex: 1;
            color: #e5e7eb;
        }
        
        /* Responsividade para Notifica√ß√µes */
        @media (max-width: 768px) {
            .toast-container {
                top: 10px;
                right: 10px;
                left: 10px;
                max-width: none;
            }
            
            .toast {
                min-width: auto;
                padding: 12px 16px;
            }
            
            .detailed-progress {
                padding: 12px;
            }
            
            .realtime-logs {
                max-height: 150px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <!-- Container de Notifica√ß√µes Toast -->
    <div id="toastContainer" class="toast-container"></div>
    
    <div class="container">
        <header class="page-header">
            <!-- Bot√£o de Voltar -->
            <a href="index.html" class="back-button">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                Voltar
            </a>
            
            <h1 class="page-title">
                <span class="page-icon">üß†</span>
                Infer√™ncia com Modelos GPT
            </h1>
            <p class="page-subtitle">Explore como modelos treinados geram texto de forma interativa</p>
        </header>

        <main class="grid-layout">
            <!-- Painel de Controle -->
            <div class="control-panel">
                <div class="glass-card">
                    <div class="section-header">
                        <h2 class="section-title">
                            <span class="section-icon">‚öôÔ∏è</span>
                            Configura√ß√µes de Infer√™ncia
                        </h2>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">üìù</span>
                                Prompt Inicial
                            </label>
                            <textarea id="promptInput" class="form-input" style="height: 80px; resize: none;" placeholder="Digite o prompt inicial...">Era uma vez uma</textarea>
                        </div>
                        
                        <!-- Visualiza√ß√£o de Tokeniza√ß√£o -->
                        <div id="tokenizationVisualization" class="glass-card">
                            <div class="section-header">
                                <h3 class="section-title">
                                    <span class="section-icon">üî§</span>
                                    Tokeniza√ß√£o do Prompt
                                </h3>
                            </div>
                            <div class="space-y-3">
                                 <div class="form-group">
                                     <label class="form-label">Texto Original:</label>
                                     <div id="originalText" class="code-block">
                                         Era uma vez uma
                                     </div>
                                 </div>
                                 <div class="flex items-center justify-center py-2">
                                     <div class="tokenization-arrow">
                                         <span class="text-2xl">‚¨áÔ∏è</span>
                                         <span class="text-xs text-gray-400 ml-2">Tokeniza√ß√£o</span>
                                     </div>
                                 </div>
                                 <div class="form-group">
                                     <label class="form-label">Tokens Gerados:</label>
                                     <div id="tokenizedOutput" class="token-container">
                                        <div class="token-item" data-token-id="0">
                                            <span class="token-text">Era</span>
                                            <span class="token-id">[1234]</span>
                                        </div>
                                        <div class="token-item" data-token-id="1">
                                            <span class="token-text">uma</span>
                                            <span class="token-id">[5678]</span>
                                        </div>
                                        <div class="token-item" data-token-id="2">
                                            <span class="token-text">vez</span>
                                            <span class="token-id">[9012]</span>
                                        </div>
                                        <div class="token-item" data-token-id="3">
                                            <span class="token-text">uma</span>
                                            <span class="token-id">[5678]</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">üî¢</span>
                                M√°ximo de Tokens
                            </label>
                            <input type="range" id="maxTokens" min="5" max="50" value="20" class="form-range">
                            <span id="maxTokensValue" class="range-value">20 tokens</span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">üå°Ô∏è</span>
                                Temperatura
                            </label>
                            <input type="range" id="temperature" min="1" max="200" value="70" class="form-range">
                            <span id="temperatureValue" class="range-value">0.7</span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">üéØ</span>
                                Top-p (Nucleus)
                            </label>
                            <input type="range" id="topP" min="10" max="100" value="90" class="form-range">
                            <span id="topPValue" class="range-value">0.9</span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">üîù</span>
                                Top-k
                            </label>
                            <input type="range" id="topK" min="1" max="100" value="50" class="form-range">
                            <span id="topKValue" class="range-value">50</span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">üì°</span>
                                Beam Width
                            </label>
                            <input type="range" id="beamWidth" min="1" max="8" value="3" class="form-range">
                            <span id="beamWidthValue" class="range-value">3 beams</span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">üé≤</span>
                                M√©todo de Sampling
                            </label>
                            <div class="grid grid-cols-2 gap-2">
                                <div class="sampling-method active" data-method="greedy">
                                    <div class="font-semibold">Greedy</div>
                                    <div class="text-xs opacity-75">Sempre o melhor</div>
                                </div>
                                <div class="sampling-method" data-method="random">
                                    <div class="font-semibold">Random</div>
                                    <div class="text-xs opacity-75">Amostragem</div>
                                </div>
                                <div class="sampling-method" data-method="nucleus">
                                    <div class="font-semibold">Nucleus</div>
                                    <div class="text-xs opacity-75">Top-p</div>
                                </div>
                                <div class="sampling-method" data-method="beam">
                                    <div class="font-semibold">Beam</div>
                                    <div class="text-xs opacity-75">Busca em feixe</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="showProbabilities" class="form-checkbox" checked>
                                <span class="checkbox-text">Mostrar Probabilidades</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="showAttention" class="form-checkbox">
                                <span class="checkbox-text">Visualizar Aten√ß√£o</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Status e Progress Bar -->
                    <div id="generationStatus" class="mt-4" style="display: none;">
                        <div class="progress-container">
                            <div id="progressBar" class="progress-bar" style="width: 0%;"></div>
                        </div>
                        <div id="statusMessage" class="status-message status-info">
                            <div class="typing-indicator">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                            </div>
                            <span>Preparando gera√ß√£o...</span>
                        </div>
                    </div>
                    
                    <!-- Barra de Progresso -->
                    <div id="generationStatus" class="progress-container mb-4" style="display: none;">
                        <div class="progress-label text-sm font-medium mb-2">Progresso da Gera√ß√£o</div>
                        <div class="progress-track bg-gray-700 rounded-full h-2 overflow-hidden">
                            <div id="progressBar" class="progress-bar bg-gradient-to-r from-blue-500 to-green-500 h-full transition-all duration-300" style="width: 0%;"></div>
                        </div>
                        <div class="progress-percentage text-xs text-gray-400 mt-1">0%</div>
                    </div>
                    
                    <!-- √Årea de Status -->
                    <div id="statusMessage" class="status-message status-info mb-4" style="display: none;">
                        <div class="status-icon mr-2">‚ÑπÔ∏è</div>
                        <span class="flex-1">Status da gera√ß√£o...</span>
                    </div>
                    
                    <button id="generateText" class="btn btn-primary btn-full btn-icon">
                        <span id="generateTextLabel">üöÄ Gerar Texto</span>
                        <div id="generateSpinner" class="spinner" style="display: none;"></div>
                    </button>
                    
                    <button id="stepGenerate" class="btn btn-secondary btn-full btn-icon">
                        <span id="stepGenerateLabel">üë£ Gerar Passo a Passo</span>
                        <div id="stepSpinner" class="spinner" style="display: none;"></div>
                    </button>
                    
                    <button id="resetGeneration" class="btn btn-outline btn-full btn-icon">
                        <span id="resetGenerationLabel">üîÑ Resetar</span>
                    </button>
                    
                    <button id="testNotifications" class="btn btn-secondary btn-full btn-icon">
                        <span id="testNotificationsLabel">üîî Testar Notifica√ß√µes</span>
                    </button>
                    
                    <button id="toggleSound" class="btn btn-outline btn-full btn-icon">
                        <span id="toggleSoundLabel">üîá Som Desativado</span>
                    </button>
                    
                    <!-- Progresso Detalhado -->
                    <div id="detailedProgress" class="glass-card" style="display: none;">
                        <div class="section-header">
                            <div class="section-title">Gerando Texto</div>
                            <div class="progress-percentage" id="detailedPercentage">0%</div>
                        </div>
                        <div class="progress-track">
                            <div class="progress-fill" id="detailedProgressFill" style="width: 0%;"></div>
                        </div>
                        <div class="progress-details">
                            <span id="progressTokens">0/20 tokens</span>
                            <span class="progress-eta" id="progressETA">ETA: --</span>
                        </div>
                    </div>
                    
                    <!-- Badges de Estat√≠sticas -->
                    <div class="stats-badges" id="statsBadges" style="display: none;">
                        <div class="badge badge-success">
                            <span class="badge-icon">‚úì</span>
                            <span id="successTokens">0 tokens</span>
                        </div>
                        <div class="badge" id="speedBadge">
                            <span class="badge-icon">‚ö°</span>
                            <span id="speedValue">0 t/s</span>
                        </div>
                        <div class="badge" id="qualityBadge">
                            <span class="badge-icon">üéØ</span>
                            <span id="qualityValue">--</span>
                        </div>
                    </div>
                    
                    <!-- Logs em Tempo Real -->
                    <div id="realtimeLogs" class="glass-card" style="display: none;">
                        <div class="log-entry">
                            <span class="log-timestamp">00:00</span>
                            <span class="log-level info">INFO</span>
                            <span class="log-message">Sistema pronto para gera√ß√£o</span>
                        </div>
                    </div>
                    
                    <!-- M√©tricas de Gera√ß√£o -->
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-label">Tokens</div>
                            <div class="metric-value" id="tokensGenerated">0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Velocidade</div>
                            <div class="metric-value" id="generationSpeed">0.0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Perplexidade</div>
                            <div class="metric-value" id="perplexity">0.0</div>
                        </div>
                    </div>
                </div>
                
                <!-- Etapas da Infer√™ncia -->
                <div class="glass-card">
                    <div class="section-header">
                        <h2 class="section-title">üîÑ Etapas</h2>
                    </div>
                    <div class="space-y-2">
                        <div class="step-item" data-step="tokenize">
                            <div class="step-number">1</div>
                            <h3 class="step-title">Tokeniza√ß√£o</h3>
                            <p class="step-description">Converter texto em tokens</p>
                        </div>
                        <div class="step-item" data-step="embed">
                            <div class="step-number">2</div>
                            <h3 class="step-title">Embeddings</h3>
                            <p class="step-description">Converter tokens em vetores</p>
                        </div>
                        <div class="step-item" data-step="forward">
                            <div class="step-number">3</div>
                            <h3 class="step-title">Forward Pass</h3>
                            <p class="step-description">Processar atrav√©s do modelo</p>
                        </div>
                        <div class="step-item" data-step="sample">
                            <div class="step-number">4</div>
                            <h3 class="step-title">Sampling</h3>
                            <p class="step-description">Escolher pr√≥ximo token</p>
                        </div>
                        <div class="step-item" data-step="decode">
                            <div class="step-number">5</div>
                            <h3 class="step-title">Decodifica√ß√£o</h3>
                            <p class="step-description">Converter token em texto</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o Principal -->
            <div class="lg:col-span-3 space-y-6">
                <!-- Texto Gerado -->
                <div class="glass-card">
                    <div class="section-header">
                        <h2 class="section-title">üìù Texto Gerado</h2>
                    </div>
                    <div id="generatedText" class="code-block">
                        <span class="text-gray-400">O texto gerado aparecer√° aqui...</span>
                    </div>
                    
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-label">Tokens Gerados</div>
                            <div class="metric-value" id="tokensGeneratedDisplay">0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Velocidade</div>
                            <div class="metric-value" id="generationSpeedDisplay">0</div>
                            <div class="metric-unit">tokens/s</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Perplexidade</div>
                            <div class="metric-value" id="perplexityDisplay">0.0</div>
                        </div>
                    </div>
                </div>
                
                <!-- Visualiza√ß√£o do Fluxo de Infer√™ncia -->
                <div class="glass-card">
                    <div class="section-header">
                        <h2 class="section-title">üîÑ Fluxo de Infer√™ncia</h2>
                    </div>
                    <div id="inferenceFlow" class="inference-flow space-y-4">
                        <!-- Etapa 1: Tokeniza√ß√£o -->
                        <div class="step-item" data-step="tokenize">
                            <div class="step-icon">üî§</div>
                            <div class="step-content">
                                <h3 class="step-title">1. Tokeniza√ß√£o</h3>
                                <p class="step-description">Convertendo texto em tokens...</p>
                                <div class="flow-tokens" id="tokenizeTokens">
                                    <!-- Tokens ser√£o adicionados dinamicamente -->
                                </div>
                            </div>
                            <div class="step-connector"></div>
                        </div>
                        
                        <!-- Etapa 2: Embeddings -->
                        <div class="step-item" data-step="embed">
                            <div class="step-icon">üìä</div>
                            <div class="step-content">
                                <h3 class="step-title">2. Embeddings</h3>
                                <p class="step-description">Convertendo tokens em vetores...</p>
                                <div class="flow-tokens" id="embedTokens">
                                    <!-- Vetores ser√£o representados aqui -->
                                </div>
                            </div>
                            <div class="step-connector"></div>
                        </div>
                        
                        <!-- Etapa 3: Attention -->
                        <div class="step-item" data-step="attention">
                            <div class="step-icon">üëÅÔ∏è</div>
                            <div class="step-content">
                                <h3 class="step-title">3. Mecanismo de Aten√ß√£o</h3>
                                <p class="step-description">Calculando rela√ß√µes entre tokens...</p>
                                <div class="flow-tokens" id="attentionTokens">
                                    <!-- Pesos de aten√ß√£o ser√£o mostrados aqui -->
                                </div>
                            </div>
                            <div class="step-connector"></div>
                        </div>
                        
                        <!-- Etapa 4: Forward Pass -->
                        <div class="step-item" data-step="forward">
                            <div class="step-icon">‚ö°</div>
                            <div class="step-content">
                                <h3 class="step-title">4. Forward Pass</h3>
                                <p class="step-description">Processando atrav√©s das camadas...</p>
                                <div class="flow-tokens" id="forwardTokens">
                                    <!-- Representa√ß√£o do processamento -->
                                </div>
                            </div>
                            <div class="step-connector"></div>
                        </div>
                        
                        <!-- Etapa 5: Sampling -->
                        <div class="step-item" data-step="sample">
                            <div class="step-icon">üé≤</div>
                            <div class="step-content">
                                <h3 class="step-title">5. Sampling</h3>
                                <p class="step-description">Escolhendo o pr√≥ximo token...</p>
                                <div class="flow-tokens" id="sampleTokens">
                                    <!-- Candidatos e probabilidades -->
                                </div>
                            </div>
                            <div class="step-connector"></div>
                        </div>
                        
                        <!-- Etapa 6: Decodifica√ß√£o -->
                        <div class="step-item" data-step="decode">
                            <div class="step-icon">üìù</div>
                            <div class="step-content">
                                <h3 class="step-title">6. Decodifica√ß√£o</h3>
                                <p class="step-description">Convertendo token em texto...</p>
                                <div class="flow-tokens" id="decodeTokens">
                                    <!-- Texto final -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Probabilidades dos Tokens -->
                <div class="glass-card" id="probabilitiesSection">
                    <div class="section-header">
                        <h2 class="section-title">üìä Probabilidades dos Pr√≥ximos Tokens</h2>
                    </div>
                    <div id="tokenProbabilities" class="space-y-2">
                        <!-- Ser√° preenchido dinamicamente -->
                    </div>
                </div>
                
                <!-- Beam Search -->
                <div class="glass-card" id="beamSearchSection" style="display: none;">
                    <div class="section-header">
                        <h2 class="section-title">üîç Beam Search</h2>
                    </div>
                    <div id="beamCandidates" class="space-y-2">
                        <!-- Ser√° preenchido dinamicamente -->
                    </div>
                </div>
                
                <!-- Visualiza√ß√£o de Aten√ß√£o -->
                <div class="glass-card" id="attentionSection" style="display: none;">
                    <div class="section-header">
                        <h2 class="section-title">üëÅÔ∏è Mapa de Aten√ß√£o</h2>
                    </div>
                    <div class="grid-layout">
                        <div>
                            <h3 class="section-subtitle">Cabe√ßas de Aten√ß√£o</h3>
                            <div id="attentionHeads" class="grid grid-cols-4 gap-2">
                                <!-- Ser√° preenchido dinamicamente -->
                            </div>
                        </div>
                        <div>
                            <h3 class="section-subtitle">Matriz de Aten√ß√£o</h3>
                            <div id="attentionMatrix" class="visualization-container">
                                <canvas id="attentionCanvas" width="300" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Logits e Softmax -->
                <div class="glass-card">
                    <div class="section-header">
                        <h2 class="section-title">üìà Logits e Softmax</h2>
                    </div>
                    <div class="grid-layout">
                        <div>
                            <h3 class="section-subtitle">Logits Brutos</h3>
                            <div id="rawLogits" class="space-y-2">
                                <!-- Ser√° preenchido dinamicamente -->
                            </div>
                        </div>
                        <div>
                            <h3 class="section-subtitle">Ap√≥s Softmax</h3>
                            <div id="softmaxProbs" class="space-y-2">
                                <!-- Ser√° preenchido dinamicamente -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <h3 class="section-subtitle">Efeito da Temperatura</h3>
                        <div class="metrics-grid">
                            <div class="metric-card text-center">
                                <div class="metric-label">Baixa (0.1)</div>
                                <div class="visualization-container">
                                    <div class="text-center">
                                        <div class="metric-value">Determin√≠stico</div>
                                        <div class="metric-description">Sempre o mesmo</div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-card text-center">
                                <div class="metric-label">M√©dia (1.0)</div>
                                <div class="visualization-container">
                                    <div class="text-center">
                                        <div class="metric-value">Balanceado</div>
                                        <div class="metric-description">Criativo e coerente</div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-card text-center">
                                <div class="metric-label">Alta (2.0)</div>
                                <div class="visualization-container">
                                    <div class="text-center">
                                        <div class="metric-value">Criativo</div>
                                        <div class="metric-description">Mais aleat√≥rio</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Log de Gera√ß√£o -->
                <div class="glass-card">
                    <div class="section-header">
                        <h2 class="section-title">üìù Log de Gera√ß√£o</h2>
                    </div>
                    <div id="generationLog" class="code-block h-40 overflow-y-auto">
                        <div class="text-green-400">[INFO] Sistema de infer√™ncia inicializado</div>
                        <div class="text-blue-400">[INFO] Aguardando prompt para gera√ß√£o...</div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- ELEMENTOS DO DOM ---
        const promptInput = document.getElementById('promptInput');
        const maxTokens = document.getElementById('maxTokens');
        const maxTokensValue = document.getElementById('maxTokensValue');
        const temperature = document.getElementById('temperature');
        const temperatureValue = document.getElementById('temperatureValue');
        const topP = document.getElementById('topP');
        const topPValue = document.getElementById('topPValue');
        const topK = document.getElementById('topK');
        const topKValue = document.getElementById('topKValue');
        const beamWidth = document.getElementById('beamWidth');
        const beamWidthValue = document.getElementById('beamWidthValue');
        const showProbabilities = document.getElementById('showProbabilities');
        const showAttention = document.getElementById('showAttention');
        const generateText = document.getElementById('generateText');
        const stepGenerate = document.getElementById('stepGenerate');
        const resetGeneration = document.getElementById('resetGeneration');
        
        const generatedText = document.getElementById('generatedText');
        const tokensGenerated = document.getElementById('tokensGenerated');
        const generationSpeed = document.getElementById('generationSpeed');
        const perplexity = document.getElementById('perplexity');
        const tokenProbabilities = document.getElementById('tokenProbabilities');
        const beamCandidates = document.getElementById('beamCandidates');
        const attentionHeads = document.getElementById('attentionHeads');
        const rawLogits = document.getElementById('rawLogits');
        const softmaxProbs = document.getElementById('softmaxProbs');
        const generationLog = document.getElementById('generationLog');
        const stepItems = document.querySelectorAll('.step-item');
        const samplingMethods = document.querySelectorAll('.sampling-method');
        
        const probabilitiesSection = document.getElementById('probabilitiesSection');
        const beamSearchSection = document.getElementById('beamSearchSection');
        const attentionSection = document.getElementById('attentionSection');
        
        // --- ESTADO DA APLICA√á√ÉO ---
        let currentTokens = [];
        let isGenerating = false;
        let generationStartTime = 0;
        let currentSamplingMethod = 'greedy';
        let stepByStep = false;
        let currentStep = 0;
        let beams = [];
        
        // Vocabul√°rio simulado
        const vocabulary = [
            'princesa', 'castelo', 'floresta', 'drag√£o', 'cavaleiro', 'reino', 'magia',
            'aventura', 'tesouro', 'espada', 'coroa', 'torre', 'ponte', 'rio',
            'montanha', 'vale', 'cidade', 'aldeia', 'caminho', 'jornada', 'destino',
            'amigo', 'inimigo', 'batalha', 'vit√≥ria', 'derrota', 'coragem', 'medo',
            'amor', '√≥dio', 'esperan√ßa', 'sonho', 'realidade', 'fantasia', 'lenda',
            'hist√≥ria', 'conto', 'f√°bula', 'mito', 'verdade', 'mentira', 'segredo',
            'mist√©rio', 'enigma', 'resposta', 'pergunta', 'busca', 'encontro',
            'partida', 'chegada', 'in√≠cio', 'fim', 'meio', 'antes', 'depois',
            'sempre', 'nunca', 'talvez', 'certamente', 'possivelmente', 'realmente',
            'muito', 'pouco', 'grande', 'pequeno', 'alto', 'baixo', 'forte', 'fraco',
            'r√°pido', 'lento', 'novo', 'velho', 'jovem', 'antigo', 'moderno',
            'belo', 'feio', 'bom', 'mau', 'certo', 'errado', 'f√°cil', 'dif√≠cil',
            'simples', 'complexo', 'claro', 'escuro', 'luz', 'sombra', 'dia', 'noite',
            'sol', 'lua', 'estrela', 'c√©u', 'terra', 'mar', 'fogo', '√°gua', 'ar',
            '√°rvore', 'flor', 'p√°ssaro', 'peixe', 'animal', 'pessoa', 'crian√ßa',
            'adulto', 'homem', 'mulher', 'menino', 'menina', 'pai', 'm√£e', 'filho',
            'filha', 'irm√£o', 'irm√£', 'av√¥', 'av√≥', 'tio', 'tia', 'primo', 'prima',
            'e', 'ou', 'mas', 'porque', 'quando', 'onde', 'como', 'que', 'quem',
            'o', 'a', 'um', 'uma', 'os', 'as', 'uns', 'umas', 'de', 'do', 'da',
            'em', 'no', 'na', 'por', 'para', 'com', 'sem', 'sobre', 'sob', 'entre'
        ];
        
        // --- FUN√á√ïES UTILIT√ÅRIAS ---
        
        /**
         * Simula logits para o vocabul√°rio
         */
        function generateLogits(context) {
            const logits = {};
            
            // Gera logits baseados no contexto
            vocabulary.forEach(word => {
                let score = Math.random() * 10 - 5; // Base aleat√≥ria
                
                // Ajusta baseado no contexto
                if (context.includes('princesa')) {
                    if (['castelo', 'reino', 'coroa', 'belo'].includes(word)) {
                        score += 3;
                    }
                }
                if (context.includes('drag√£o')) {
                    if (['fogo', 'cavaleiro', 'batalha', 'medo'].includes(word)) {
                        score += 3;
                    }
                }
                if (context.includes('floresta')) {
                    if (['√°rvore', 'animal', 'mist√©rio', 'escuro'].includes(word)) {
                        score += 3;
                    }
                }
                
                logits[word] = score;
            });
            
            return logits;
        }
        
        /**
         * Aplica softmax aos logits
         */
        function softmax(logits, temp = 1.0) {
            const words = Object.keys(logits);
            const values = words.map(w => logits[w] / temp);
            
            // Subtrai o m√°ximo para estabilidade num√©rica
            const maxVal = Math.max(...values);
            const expValues = values.map(v => Math.exp(v - maxVal));
            const sumExp = expValues.reduce((a, b) => a + b, 0);
            
            const probs = {};
            words.forEach((word, i) => {
                probs[word] = expValues[i] / sumExp;
            });
            
            return probs;
        }
        
        /**
         * Sampling greedy
         */
        function greedySample(probs) {
            let maxProb = 0;
            let bestWord = '';
            
            Object.entries(probs).forEach(([word, prob]) => {
                if (prob > maxProb) {
                    maxProb = prob;
                    bestWord = word;
                }
            });
            
            return bestWord;
        }
        
        /**
         * Sampling aleat√≥rio
         */
        function randomSample(probs) {
            const words = Object.keys(probs);
            const probValues = Object.values(probs);
            
            let cumSum = 0;
            const random = Math.random();
            
            for (let i = 0; i < words.length; i++) {
                cumSum += probValues[i];
                if (random <= cumSum) {
                    return words[i];
                }
            }
            
            return words[words.length - 1];
        }
        
        /**
         * Nucleus sampling (top-p)
         */
        function nucleusSample(probs, p = 0.9) {
            const sorted = Object.entries(probs)
                .sort(([,a], [,b]) => b - a);
            
            let cumSum = 0;
            const nucleus = [];
            
            for (const [word, prob] of sorted) {
                cumSum += prob;
                nucleus.push([word, prob]);
                if (cumSum >= p) break;
            }
            
            // Renormaliza
            const nucleusSum = nucleus.reduce((sum, [,prob]) => sum + prob, 0);
            const nucleusProbs = {};
            nucleus.forEach(([word, prob]) => {
                nucleusProbs[word] = prob / nucleusSum;
            });
            
            return randomSample(nucleusProbs);
        }
        
        /**
         * Top-k sampling
         */
        function topKSample(probs, k = 50) {
            const sorted = Object.entries(probs)
                .sort(([,a], [,b]) => b - a)
                .slice(0, k);
            
            const topKProbs = {};
            const sum = sorted.reduce((s, [,prob]) => s + prob, 0);
            
            sorted.forEach(([word, prob]) => {
                topKProbs[word] = prob / sum;
            });
            
            return randomSample(topKProbs);
        }
        
        /**
         * Beam search
         */
        function beamSearch(context, beamSize = 3) {
            if (beams.length === 0) {
                // Inicializa beams
                const logits = generateLogits(context);
                const temp = parseFloat(temperatureValue.textContent);
                const probs = softmax(logits, temp);
                
                const sorted = Object.entries(probs)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, beamSize);
                
                beams = sorted.map(([word, prob]) => ({
                    sequence: [word],
                    score: Math.log(prob),
                    prob: prob
                }));
            } else {
                // Expande beams existentes
                const newBeams = [];
                
                beams.forEach(beam => {
                    const beamContext = context.concat(beam.sequence);
                    const logits = generateLogits(beamContext);
                    const temp = parseFloat(temperatureValue.textContent);
                    const probs = softmax(logits, temp);
                    
                    const sorted = Object.entries(probs)
                        .sort(([,a], [,b]) => b - a)
                        .slice(0, 5); // Top 5 para cada beam
                    
                    sorted.forEach(([word, prob]) => {
                        newBeams.push({
                            sequence: beam.sequence.concat([word]),
                            score: beam.score + Math.log(prob),
                            prob: beam.prob * prob
                        });
                    });
                });
                
                // Mant√©m apenas os melhores beams
                beams = newBeams
                    .sort((a, b) => b.score - a.score)
                    .slice(0, beamSize);
            }
            
            return beams[0].sequence[beams[0].sequence.length - 1];
        }
        
        /**
         * Adiciona mensagem ao log
         */
        function logMessage(message, color = 'white') {
            const logDiv = document.createElement('div');
            logDiv.className = `text-${color}-400`;
            logDiv.textContent = message;
            generationLog.appendChild(logDiv);
            generationLog.scrollTop = generationLog.scrollHeight;
        }
        
        // --- FUN√á√ïES DE VISUALIZA√á√ÉO ---
        
        /**
         * Atualiza valores dos sliders
         */
        function updateSliderValues() {
            maxTokensValue.textContent = `${maxTokens.value} tokens`;
            temperatureValue.textContent = (parseInt(temperature.value) / 100).toFixed(1);
            topPValue.textContent = (parseInt(topP.value) / 100).toFixed(1);
            topKValue.textContent = topK.value;
            beamWidthValue.textContent = `${beamWidth.value} beams`;
        }
        
        /**
         * Atualiza texto gerado
         */
        function updateGeneratedText() {
            if (currentTokens.length === 0) {
                generatedText.innerHTML = '<span class="text-gray-400">O texto gerado aparecer√° aqui...</span>';
                return;
            }
            
            const html = [];
            
            // Apenas tokens gerados (sem incluir o prompt)
            currentTokens.forEach((token, index) => {
                const isLast = index === currentTokens.length - 1;
                const className = isLast && isGenerating ? 'token current' : 'token generated';
                html.push(`<span class="${className}">${token}</span>`);
            });
            
            generatedText.innerHTML = html.join(' ');
        }
        
        /**
         * Exibe probabilidades dos tokens
         */
        function displayTokenProbabilities(probs) {
            if (!showProbabilities.checked) {
                probabilitiesSection.style.display = 'none';
                return;
            }
            
            probabilitiesSection.style.display = 'block';
            
            const sorted = Object.entries(probs)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);
            
            tokenProbabilities.innerHTML = '';
            
            sorted.forEach(([word, prob]) => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-2 bg-white/10 rounded-lg';
                
                div.innerHTML = `
                    <span class="font-semibold">${word}</span>
                    <div class="flex items-center space-x-2 flex-1 ml-4">
                        <div class="probability-bar flex-1">
                            <div class="probability-fill" style="width: ${prob * 100}%"></div>
                        </div>
                        <span class="text-sm font-mono">${(prob * 100).toFixed(1)}%</span>
                    </div>
                `;
                
                tokenProbabilities.appendChild(div);
            });
        }
        
        /**
         * Exibe logits e softmax
         */
        function displayLogitsAndSoftmax(logits, probs) {
            const sorted = Object.entries(logits)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 8);
            
            // Logits brutos
            rawLogits.innerHTML = '';
            sorted.forEach(([word, logit]) => {
                const div = document.createElement('div');
                div.className = 'logit-bar';
                
                const normalizedLogit = Math.max(0, (logit + 5) / 10); // Normaliza para 0-1
                
                div.innerHTML = `
                    <div class="logit-fill" style="width: ${normalizedLogit * 100}%">
                        ${word}: ${logit.toFixed(2)}
                    </div>
                `;
                
                rawLogits.appendChild(div);
            });
            
            // Probabilidades ap√≥s softmax
            softmaxProbs.innerHTML = '';
            sorted.forEach(([word]) => {
                const prob = probs[word];
                const div = document.createElement('div');
                div.className = 'logit-bar';
                
                div.innerHTML = `
                    <div class="logit-fill" style="width: ${prob * 100}%">
                        ${word}: ${(prob * 100).toFixed(1)}%
                    </div>
                `;
                
                softmaxProbs.appendChild(div);
            });
        }
        
        /**
         * Exibe beam search
         */
        function displayBeamSearch() {
            if (currentSamplingMethod !== 'beam') {
                beamSearchSection.style.display = 'none';
                return;
            }
            
            beamSearchSection.style.display = 'block';
            beamCandidates.innerHTML = '';
            
            beams.forEach((beam, index) => {
                const div = document.createElement('div');
                div.className = index === 0 ? 'beam selected' : 'beam';
                
                div.innerHTML = `
                    <div class="beam-score">${beam.score.toFixed(2)}</div>
                    <div class="font-semibold mb-2">Beam ${index + 1}</div>
                    <div class="text-sm">${beam.sequence.join(' ')}</div>
                    <div class="text-xs opacity-75 mt-1">Prob: ${(beam.prob * 100).toFixed(2)}%</div>
                `;
                
                beamCandidates.appendChild(div);
            });
        }
        
        /**
         * Simula visualiza√ß√£o de aten√ß√£o
         */
        function displayAttention() {
            if (!showAttention.checked) {
                attentionSection.style.display = 'none';
                return;
            }
            
            attentionSection.style.display = 'block';
            
            // Cabe√ßas de aten√ß√£o
            attentionHeads.innerHTML = '';
            for (let i = 0; i < 12; i++) {
                const head = document.createElement('div');
                head.className = i < 3 ? 'attention-head active' : 'attention-head';
                head.textContent = `H${i + 1}`;
                attentionHeads.appendChild(head);
            }
            
            // Matriz de aten√ß√£o (simulada)
            const canvas = document.getElementById('attentionCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const tokens = promptInput.value.trim().split(/\s+/).concat(currentTokens);
            const size = Math.min(tokens.length, 10);
            const cellSize = canvas.width / size;
            
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    const attention = Math.random();
                    const alpha = attention * 0.8 + 0.1;
                    
                    ctx.fillStyle = `rgba(59, 130, 246, ${alpha})`;
                    ctx.fillRect(j * cellSize, i * cellSize, cellSize - 1, cellSize - 1);
                }
            }
        }
        
        /**
         * Destaca etapa atual
         */
        function highlightStep(stepName) {
            stepItems.forEach(item => {
                item.classList.remove('active');
                if (item.dataset.step === stepName) {
                    item.classList.add('active');
                }
            });
        }
        
        /**
         * Atualiza m√©tricas
         */
        function updateMetrics() {
            tokensGenerated.textContent = currentTokens.length;
            
            if (generationStartTime > 0) {
                const elapsed = (Date.now() - generationStartTime) / 1000;
                const speed = currentTokens.length / elapsed;
                generationSpeed.textContent = speed.toFixed(1);
            }
            
            // Simula perplexidade
            const perp = Math.exp(Math.random() * 2 + 1);
            perplexity.textContent = perp.toFixed(1);
        }
        
        // --- FUN√á√ïES DE GERA√á√ÉO ---
        
        /**
         * Gera pr√≥ximo token
         */
        function generateNextToken() {
            const context = promptInput.value.trim().split(/\s+/).concat(currentTokens);
            const logits = generateLogits(context);
            const temp = parseFloat(temperatureValue.textContent);
            const probs = softmax(logits, temp);
            
            let nextToken;
            
            switch (currentSamplingMethod) {
                case 'greedy':
                    nextToken = greedySample(probs);
                    break;
                case 'random':
                    nextToken = randomSample(probs);
                    break;
                case 'nucleus':
                    const p = parseFloat(topPValue.textContent);
                    nextToken = nucleusSample(probs, p);
                    break;
                case 'beam':
                    const beamSize = parseInt(beamWidth.value);
                    nextToken = beamSearch(context, beamSize);
                    break;
                default:
                    nextToken = greedySample(probs);
            }
            
            currentTokens.push(nextToken);
            
            // Atualiza visualiza√ß√µes
            displayTokenProbabilities(probs);
            displayLogitsAndSoftmax(logits, probs);
            displayBeamSearch();
            displayAttention();
            updateGeneratedText();
            updateMetrics();
            
            logMessage(`[GEN] Token gerado: "${nextToken}" (m√©todo: ${currentSamplingMethod})`, 'green');
            
            return nextToken;
        }
        
        /**
         * Inicia gera√ß√£o autom√°tica
         */
        function startGeneration() {
            if (isGenerating) return;
            
            isGenerating = true;
            generationStartTime = Date.now();
            generateText.disabled = true;
            stepGenerate.disabled = true;
            
            const maxTokensNum = parseInt(maxTokens.value);
            
            logMessage('[INFO] Iniciando gera√ß√£o autom√°tica...', 'blue');
            
            const generateInterval = setInterval(() => {
                if (currentTokens.length >= maxTokensNum) {
                    clearInterval(generateInterval);
                    isGenerating = false;
                    generateText.disabled = false;
                    stepGenerate.disabled = false;
                    logMessage('[INFO] Gera√ß√£o conclu√≠da!', 'green');
                    return;
                }
                
                // Simula etapas
                highlightStep('tokenize');
                setTimeout(() => {
                    highlightStep('embed');
                    setTimeout(() => {
                        highlightStep('forward');
                        setTimeout(() => {
                            highlightStep('sample');
                            setTimeout(() => {
                                highlightStep('decode');
                                generateNextToken();
                            }, 200);
                        }, 200);
                    }, 200);
                }, 200);
            }, 1500);
        }
        
        /**
         * Gera√ß√£o passo a passo
         */
        function stepGeneration() {
            if (isGenerating) return;
            
            const maxTokensNum = parseInt(maxTokens.value);
            
            if (currentTokens.length >= maxTokensNum) {
                logMessage('[INFO] M√°ximo de tokens atingido!', 'yellow');
                return;
            }
            
            if (!stepByStep) {
                stepByStep = true;
                generationStartTime = Date.now();
                logMessage('[INFO] Iniciando gera√ß√£o passo a passo...', 'blue');
            }
            
            const steps = ['tokenize', 'embed', 'forward', 'sample', 'decode'];
            
            if (currentStep < steps.length) {
                highlightStep(steps[currentStep]);
                
                let message = '';
                switch (steps[currentStep]) {
                    case 'tokenize':
                        message = 'Tokenizando entrada...';
                        break;
                    case 'embed':
                        message = 'Convertendo tokens em embeddings...';
                        break;
                    case 'forward':
                        message = 'Processando atrav√©s do modelo...';
                        break;
                    case 'sample':
                        message = 'Amostrando pr√≥ximo token...';
                        break;
                    case 'decode':
                        message = 'Decodificando token...';
                        break;
                }
                
                logMessage(`[STEP] ${message}`, 'cyan');
                
                currentStep++;
                
                if (currentStep >= steps.length) {
                    generateNextToken();
                    currentStep = 0;
                }
            }
        }
        
        // Fun√ß√£o resetGeneration removida - agora gerenciada pelo InferenceUI
        
        // --- EVENT LISTENERS ---
        
        // Sliders
        maxTokens.addEventListener('input', updateSliderValues);
        temperature.addEventListener('input', updateSliderValues);
        topP.addEventListener('input', updateSliderValues);
        topK.addEventListener('input', updateSliderValues);
        beamWidth.addEventListener('input', updateSliderValues);
        
        // Checkboxes
        showProbabilities.addEventListener('change', () => {
            if (currentTokens.length > 0) {
                const context = promptInput.value.trim().split(/\s+/).concat(currentTokens);
                const logits = generateLogits(context);
                const temp = parseFloat(temperatureValue.textContent);
                const probs = softmax(logits, temp);
                displayTokenProbabilities(probs);
            }
        });
        
        showAttention.addEventListener('change', displayAttention);
        
        // M√©todos de sampling
        samplingMethods.forEach(method => {
            method.addEventListener('click', () => {
                samplingMethods.forEach(m => m.classList.remove('active'));
                method.classList.add('active');
                currentSamplingMethod = method.dataset.method;
                
                logMessage(`[INFO] M√©todo de sampling alterado para: ${currentSamplingMethod}`, 'blue');
                
                // Atualiza visualiza√ß√µes espec√≠ficas
                if (currentSamplingMethod === 'beam') {
                    beams = []; // Reset beams
                    displayBeamSearch();
                } else {
                    beamSearchSection.style.display = 'none';
                }
            });
        });
        
        // Bot√µes
        generateText.addEventListener('click', startGeneration);
        stepGenerate.addEventListener('click', stepGeneration);
        // Event listener removido - agora gerenciado pelo InferenceUI
        
        // Etapas clic√°veis
        stepItems.forEach(item => {
            item.addEventListener('click', () => {
                const step = item.dataset.step;
                highlightStep(step);
                
                let message = '';
                switch (step) {
                    case 'tokenize':
                        message = 'Tokeniza√ß√£o: Converte o texto de entrada em tokens que o modelo pode processar.';
                        break;
                    case 'embed':
                        message = 'Embeddings: Transforma tokens em representa√ß√µes vetoriais densas.';
                        break;
                    case 'forward':
                        message = 'Forward Pass: Processa os embeddings atrav√©s das camadas do modelo.';
                        break;
                    case 'sample':
                        message = 'Sampling: Escolhe o pr√≥ximo token baseado nas probabilidades calculadas.';
                        break;
                    case 'decode':
                        message = 'Decodifica√ß√£o: Converte o token escolhido de volta para texto leg√≠vel.';
                        break;
                }
                
                logMessage(`[INFO] ${message}`, 'cyan');
            });
        });
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            updateSliderValues();
            updateGeneratedText();
            updateMetrics();
            initializeIntegration();
        });
        
        // --- INTEGRA√á√ÉO COM WEBSOCKET ---
        
        /**
         * Inicializa integra√ß√£o com o sistema WebSocket
         */
        function initializeIntegration() {
            // Aguarda a inicializa√ß√£o do WebDemoIntegration
            if (typeof window.webDemoIntegration !== 'undefined') {
                setupIntegrationListeners();
                loadParametersFromAPI();
            } else {
                // Tenta novamente ap√≥s um pequeno delay
                setTimeout(initializeIntegration, 100);
            }
        }
        
        /**
         * Configura listeners para integra√ß√£o
         */
        function setupIntegrationListeners() {
            const integration = window.webDemoIntegration;
            
            // Listener para mudan√ßas de par√¢metros via WebSocket
            if (integration.ws) {
                const originalOnMessage = integration.ws.onmessage;
                integration.ws.onmessage = (event) => {
                    const message = JSON.parse(event.data);
                    
                    if (message.type === 'ParameterUpdate' && message.data.module === 'inference') {
                        updateParameterFromWebSocket(message.data.parameter, message.data.value);
                    }
                    
                    // Chama o handler original
                    if (originalOnMessage) {
                        originalOnMessage(event);
                    }
                };
            }
        }
        
        /**
         * Carrega par√¢metros iniciais da API
         */
        async function loadParametersFromAPI() {
            try {
                // Usar valores padr√£o para demonstra√ß√£o
                const defaultParams = {
                    parameters: {
                        temperature: 0.7,
                        top_k: 50,
                        top_p: 0.9
                    }
                };
                
                // Atualiza controles com valores padr√£o
                if (defaultParams.parameters.temperature !== undefined) {
                    temperature.value = Math.round(defaultParams.parameters.temperature * 100);
                }
                if (defaultParams.parameters.top_k !== undefined) {
                    topK.value = defaultParams.parameters.top_k;
                }
                if (defaultParams.parameters.top_p !== undefined) {
                    topP.value = Math.round(defaultParams.parameters.top_p * 100);
                }
                
                updateSliderValues();
                logMessage('[DEMO] Par√¢metros padr√£o carregados', 'cyan');
            } catch (error) {
                console.error('Erro ao carregar par√¢metros:', error);
            }
        }
        
        /**
         * Atualiza par√¢metro recebido via WebSocket
         */
        function updateParameterFromWebSocket(parameter, value) {
            switch (parameter) {
                case 'temperature':
                    temperature.value = Math.round(value * 100);
                    break;
                case 'top_k':
                    topK.value = value;
                    break;
                case 'top_p':
                    topP.value = Math.round(value * 100);
                    break;
                case 'max_tokens':
                    maxTokens.value = value;
                    break;
            }
            
            updateSliderValues();
            logMessage(`[WS] Par√¢metro ${parameter} atualizado: ${value}`, 'blue');
        }
        
        /**
         * Sincroniza par√¢metros com a API quando alterados localmente
         */
        function syncParameterToAPI(parameter, value) {
            if (typeof window.webDemoIntegration !== 'undefined') {
                const integration = window.webDemoIntegration;
                
                // Envia via WebSocket
                integration.sendMessage({
                    type: 'ParameterUpdate',
                    data: {
                        module: 'inference',
                        parameter: parameter,
                        value: value
                    }
                });
                
                // Log da atualiza√ß√£o do par√¢metro (modo demo)
                console.log(`Par√¢metro ${parameter} atualizado para:`, value);
            }
        }
        
        /**
         * Envia dados de demonstra√ß√£o via WebSocket
         */
        function sendDemoData(data) {
            if (typeof window.webDemoIntegration !== 'undefined') {
                const integration = window.webDemoIntegration;
                
                integration.sendMessage({
                    type: 'DemoData',
                    data: {
                        module: 'inference',
                        data: data,
                        timestamp: Date.now()
                    }
                });
            }
        }
        
        // Adiciona listeners para sincroniza√ß√£o de par√¢metros
        temperature.addEventListener('input', () => {
            const value = parseFloat(temperature.value) / 100;
            syncParameterToAPI('temperature', value);
        });
        
        topK.addEventListener('input', () => {
            const value = parseInt(topK.value);
            syncParameterToAPI('top_k', value);
        });
        
        topP.addEventListener('input', () => {
            const value = parseFloat(topP.value) / 100;
            syncParameterToAPI('top_p', value);
        });
        
        maxTokens.addEventListener('input', () => {
            const value = parseInt(maxTokens.value);
            syncParameterToAPI('max_tokens', value);
        });
        
        // Modifica a fun√ß√£o generateNextToken para enviar dados via WebSocket
        const originalGenerateNextToken = generateNextToken;
        generateNextToken = function() {
            const result = originalGenerateNextToken();
            
            // Envia dados da gera√ß√£o via WebSocket
            sendDemoData({
                currentTokens: currentTokens,
                lastToken: result,
                samplingMethod: currentSamplingMethod,
                temperature: parseFloat(temperatureValue.textContent),
                topK: parseInt(topK.value),
                topP: parseFloat(topPValue.textContent),
                tokensGenerated: currentTokens.length,
                generationSpeed: parseFloat(generationSpeed.textContent),
                perplexity: parseFloat(perplexity.textContent)
            });
            
            return result;
        };
    </script>
</body>
</html>

<!-- Integra√ß√£o com JS refatorado -->
<script>
    // WebDemoIntegration j√° inicializado pelo integration.js
    if (window.webDemoIntegration) {
        window.webDemoIntegration.connectWebSocket();
        
        // Exibir notifica√ß√µes educacionais
        setTimeout(() => {
            window.webDemoIntegration.showToast('info', 'Conceitos de Infer√™ncia em GPT', 
                'Infer√™ncia √© o processo de gerar texto baseado no modelo treinado.', 5000);
        }, 1000);
        
        setTimeout(() => {
            window.webDemoIntegration.showToast('info', 'Dicas Educacionais', 
                'Explore os controles para entender como funciona a gera√ß√£o de texto.', 4000);
        }, 3000);
    }
</script>